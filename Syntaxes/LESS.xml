<?xml version="1.0"?>
<syntax name="language-root.less">
	<zones>
        
		<include collection="comment" />
		<include collection="function" />
		<include collection="variable.definition" />
		<include collection="selector.definition" />
        <include collection="mixin.definition" />
	</zones>
	<library>
		<collection name="variable.definition">
			<zone name="variable.definition">
				<expression>(@.*?):(.*?);</expression>
				<capture number="1" name="variable.definition.name"/>
				<capture number="2" name="variable.definition.value">
					<subzones>
						<include collection="variable.reference" />
						<include collection="literal" />
					</subzones>
				</capture>
			</zone>
		</collection>
		<collection name="variable.reference">
			<zone name="variable.reference">
				<expression>@[\w\-]*</expression>
			</zone>
		</collection>
		<collection name="variable.referenceString">
			<zone name="variable.referenceString">
				<expression>@{[\w\-]*}</expression>
			</zone>
		</collection>
        
        <collection name="arguments.definition">
			<zone name="arguments">
				<expression>@(\w.*?):\s?(.*?)?</expression>
                <capture number="1" name="arguments.name"/>
                <capture number="2" name="arguments.default"/>
			</zone>
		</collection>
		
        <collection name="mixin.definition">
            <zone name="mixin.parametric">
				<starts-with>
					<expression>^(\..*?)\s?(\((.*?)\))\s?({)</expression>
					<capture number="1" name="mixin.definition.name"/>
					<capture number="3" name="mixin.definition.arguments">
                        <include collection="arguments.definition" />
                    </capture>
                    <capture number="4" name="brace.curly.open"/>
				</starts-with>
				<ends-with>
					<expression>(})</expression>
                    <capture number="1" name="brace.curly.close"/>
				</ends-with>
				<subzones>
					<include collection="comment" />
					<include collection="property" />
					<include collection="selector.definition" />
					<include collection="variable.definition" />
					<include collection="mixin.reference" />
				</subzones>
			</zone>
            <zone name="mixin">
				<starts-with>
					<expression>^(\..*?)\s?({)</expression>
					<capture number="1" name="mixin.definition.name"/>
                    <capture number="2" name="brace.curly.open"/>
				</starts-with>
				<ends-with>
					<expression>(})</expression>
                    <capture number="1" name="brace.curly.close"/>
				</ends-with>
				<subzones>
					<include collection="comment" />
					<include collection="property" />
					<include collection="selector.definition" />
					<include collection="variable.definition" />
					<include collection="mixin.reference" />
				</subzones>
			</zone>
        </collection>
        
        <collection name="mixin.reference">
			<zone name="mixin.reference">
				<expression>(\..*?)(\((.*?)\))?;</expression>
				<capture number="1" name="mixin.reference.name"/>
				<capture number="3" name="mixin.reference.arguments">
                    <include collection="literal" />
                </capture>
			</zone>
		</collection>
        
		<collection name="selector.definition">
			<zone name="selector.definition">
				<starts-with>
					<expression>([\.|#]?[\w\-\s]*?)\s?({)</expression>
					<capture number="1" name="selector.definition.name"/>
                    <capture number="2" name="brace.curly.open"/>
				</starts-with>
				<ends-with>
					<expression>(})</expression>
                    <capture number="1" name="brace.curly.close"/>
				</ends-with>
				<subzones>
					<include collection="comment" />
					<include collection="property" />
					<include collection="selector.definition" />
					<include collection="variable.definition" />
					<include collection="mixin.reference" />
				</subzones>
			</zone>
		</collection>
        
		
		<collection name="property">
			<zone name="property">
				<expression>([^{]*?):(.*?);</expression>
				<capture number="1" name="property.name"/>
				<capture number="2" name="property.value">
					<subzones>
						<include collection="function" />
						<include collection="variable.reference" />
						<include collection="literal" />
					</subzones>
				</capture>
			</zone>
		</collection>
		
		<collection name="function">
			<zone name="function">
				<expression>(\w*?)\s?\((.*?)?\)</expression>
				<capture number="1" name="function.name"/>
				<capture number="2" name="function.arguments">
					<subzones>
						<include collection="function" />
						<include collection="variable.reference" />
						<include collection="literal" />
					</subzones>
				</capture>
			</zone>
		</collection>
		
		<collection name="comment">
			<zone name="comment.line">
				<starts-with>
					<expression>//</expression>
				</starts-with>
				<ends-with>
					<expression>\n</expression>
				</ends-with>
			</zone>
			<zone name="comment.block">
				<starts-with>
					<expression>/\*</expression>
				</starts-with>
				<ends-with>
					<expression>\*/</expression>
				</ends-with>
			</zone>
		</collection>
		
		<collection name="literal">
            <zone name="literal.numeric">
                <expression>\d?\.?\d?(%|px|em)?</expression>
            </zone>
            <zone name="literal.color">
                <expression>#([0-9a-zA-Z]*)</expression>
            </zone>
            <zone name="literal.definition">
                <expression>(dotted|black|solid|block)</expression>
            </zone>
            <include collection="literal.string" />
		</collection>
		
		<collection name="literal.string">
			<zone name="literal.string.singleQuote">
				<starts-with>
					<expression>'</expression>
				</starts-with>
				<ends-with>
					<expression>'</expression>
				</ends-with>
				<subzones>
					<include collection="variable.referenceString" />
				</subzones>
			</zone>
			<zone name="literal.string.doubleQuote">
				<starts-with>
					<expression>"</expression>
				</starts-with>
				<ends-with>
					<expression>"</expression>
				</ends-with>
				<subzones>
					<include collection="variable.referenceString" />
				</subzones>
			</zone>
		</collection>
	</library>
</syntax>